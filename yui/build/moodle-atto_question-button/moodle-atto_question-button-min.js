YUI.add("moodle-atto_panel-button",function(e,t){var n="atto_panel",r="panel_link",i="panel_number",s="display_mode",o="atto_panel",u={INPUTSUBMIT:"atto_media_urlentrysubmit",INPUTCANCEL:"atto_media_urlentrycancel",TEXTLINKCONTROL:"textlinkcontrol",panelIDCONTROL:"panelidcontrol",DISPLAYMODECONTROL:"displaymodecontrol"},a={TEXTLINKCONTROL:".textlinkcontrol",panelIDCONTROL:".panelidcontrol",DISPLAYMODECONTROL:".displaymodecontrol"},f='<form class="atto_form"><div id="{{elementid}}_{{innerform}}" class="mdl-align"><label for="{{elementid}}_{{TEXTLINKCONTROL}}">{{get_string "enterlinktext" component}}</label><input class="{{CSS.TEXTLINKCONTROL}}" id="{{elementid}}_{{TEXTLINKCONTROL}}" name="{{elementid}}_{{TEXTLINKCONTROL}}" value="{{defaulttextlink}}" /><label for="{{elementid}}_{{panelIDCONTROL}}">{{get_string "enterpanelid" component}}</label><input class="{{CSS.panelIDCONTROL}}" id="{{elementid}}_{{panelIDCONTROL}}" name="{{elementid}}_{{panelIDCONTROL}}" value="{{defaultpanelid}}" /><br /><br /><input type="checkbox" class="{{CSS.DISPLAYMODECONTROL}}" id="{{elementid}}_{{DISPLAYMODECONTROL}}"<label for="{{elementid}}_{{DISPLAYMODECONTROL}}">{{get_string "enterdisplaymode" component}}</label><br /><br /><button class="{{CSS.INPUTSUBMIT}}">{{get_string "insert" component}}</button></div></form>';e.namespace("M.atto_panel").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){if(this.get("disabled"))return;this.addButton({icon:"icon",iconComponent:"atto_panel",callback:this._displayDialogue})},_getTextLinkControlName:function(){return this.get("host").get("elementid")+"_"+r},_displayDialogue:function(t){t.preventDefault();var r=400,i=this.getDialogue({headerContent:M.util.get_string("dialogtitle",n),width:r+"px",focusAfterHide:!0});i.width!==r+"px"&&i.set("width",r+"px");var s=this._getFormContent(),o=e.Node.create("<div></div>");o.append(s),i.set("bodyContent",o),i.show(),this.markUpdated()},_getFormContent:function(){var t=e.Handlebars.compile(f),s=e.Node.create(t({elementid:this.get("host").get("elementid"),CSS:u,TEXTLINKCONTROL:r,component:n,defaultflavor:this.get("defaulttextlink"),panelIDCONTROL:i,component:n,defaultflavor:this.get("defaultpanelid")}));return this._form=s,this._form.one("."+u.INPUTSUBMIT).on("click",this._doInsert,this),s},_doInsert:function(e){e.preventDefault(),this.getDialogue({focusAfterHide:null}).hide();var t="",n=!1,r=this._form.one(a.TEXTLINKCONTROL),i=r.get("value");i||(t-"No link text could be found.",n=!0);var s=this._form.one(a.panelIDCONTROL),o=s.get("value");o||(t="No panel id could be found.",n=!0);var u=/^\d+$/.test(o);u||(t="panel id requires an integer value.",n=!0);var f=this._form.one(a.DISPLAYMODECONTROL),l=f.get("checked");l?displaytext="popup":displaytext="embed",n?content="{panel:"+t+"}":content=this.get("starttag")+i+"|"+o+"|"+displaytext+this.get("endtag"),this.editor.focus(),this.get("host").insertContentAtFocusPoint(content),this.markUpdated()}},{ATTRS:{disabled:{value:!1},usercontextid:{value:null},starttag:{value:""},endtag:{value:""}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
